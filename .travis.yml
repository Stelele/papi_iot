# Config file for automatic testing at travis-ci.com

language: python
python:
  - 3.8
  - 3.7
  - 3.6

env: 
  global: Dependencies - DEPS_DIR="`readlink -f $TRAVIS_BUILD_DIR/..`" - OPENCV_BUILD_DIR=$DEPS_DIR/opencv/build 

before_install:
  - travis_retry git clone --depth 1 https://github.com/Itseez/opencv.git $DEPS_DIR/opencv 
  - mkdir $OPENCV_BUILD_DIR && cd $OPENCV_BUILD_DIR 
  - cmake -DBUILD_TIFF=ON -DBUILD_opencv_java=OFF -DWITH_CUDA=OFF -DENABLE_AVX=ON -DWITH_OPENGL=ON -DWITH_OPENCL=ON -DWITH_IPP=ON -DWITH_TBB=ON -DWITH_EIGEN=ON -DWITH_V4L=ON -DBUILD_TESTS=OFF -DBUILD_PERF_TESTS=OFF -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=$(python3 -c "import sys; print(sys.prefix)") -DPYTHON_EXECUTABLE=$(which python3) -DPYTHON_INCLUDE_DIR=$(python3 -c "from distutils.sysconfig import get_python_inc; print(get_python_inc())") -DPYTHON_PACKAGES_PATH=$(python3 -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())") .. fi - make -j4 - sudo make install - echo "/usr/local/lib" | sudo tee -a /etc/ld.so.conf.d/opencv.conf - sudo ldconfig - echo "PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig" | sudo tee -a /etc/bash.bashrc - echo "export PKG_CONFIG_PATH" | sudo tee -a /etc/bash.bashrc - export PYTHONPATH=$OPENCV_BUILD_DIR/lib/python3.3/site-packages:$PYTHONPATH 
# Command to install dependencies, e.g. pip install -r requirements.txt --use-mirrors
install:
  - pip install -U tox-travis

# Command to run tests, e.g. python setup.py test
script: travis_wait tox

# Assuming you have installed the travis-ci CLI tool, after you
# create the Github repo and add it to Travis, run the
# following command to finish PyPI deployment setup:
# $ travis encrypt --add deploy.password
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: GiftMugweni
  password:
    secure: PLEASE_REPLACE_ME
  on:
    tags: true
    repo: Stelele/papi_iot
    python: 3.8
